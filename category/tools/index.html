<!doctype html>
<html lang="en">
	<head>
		<link rel="stylesheet" href="../../reset.css" />
		<link rel="stylesheet" href="../../base.css" />
		<meta charset="utf-8" />
		<meta name="color-scheme" content="dark">
		<link rel="icon" href="../../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../../_app/immutable/assets/Layout.BC5Y1jTu.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Button.CO_IFsgN.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/ArticleFeed.COlA-k9G.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Tags.zOjeMBQI.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.CdXfjAUR.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/entry.n3NZvpFp.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/runtime.CL55K65K.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.CKEXZrLS.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.B26TLaZb.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/preload-helper.C1FmrZbK.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/render.CC6IpZNF.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/events.CZHO4uHy.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/disclose-version.pcXP8nla.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/if.MIU4WiqH.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/props.BF2gUOm6.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/store.BBvoG5rH.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index-client.DxYZKCH8.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.bsMdv7Qd.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/snippet.CudX_7N8.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/25.BHTyXLCZ.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/legacy.DLBMJjTQ.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/lifecycle.C2XJTX65.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/Layout.hF4QT5ki.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/_commonjsHelpers.IXgdudvv.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/slot.p2w1RJjT.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/Theming.CVjcmEt6.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/Button.6yO6gXEz.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/Utils.CYFPyv2a.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/attributes.Dg39Wyaa.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/ArticleFeed.CAdTeXuT.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/Tags.BsadNXbU.js">
	</head>
	<body>
		<div style="display: contents"><!--[--><!--[--><!----><!--[!--><!----><div style="background-color: black; background-image: url();" class="bg svelte-rfb14"><!--[!--><!--]--></div><!----> <div class="layout svelte-1kupl3e"><div class="header svelte-1kupl3e"><div class="title"><a class="site-title svelte-1kupl3e" rel="author" href="/"><span style="color:palevioletred">hey</span><span style="color:orange">joe</span><span style="color:skyblue">way</span><span style="color:white">.</span></a></div> <div class="nav svelte-1kupl3e"><div style="width: default; height: 32px;" class="clickable svelte-1f9eqjh"><!--[--><a href="/articles" data-sveltekit-reload="false" data-sveltekit-preload-data="hover" class="svelte-1f9eqjh"><!--[!--><!----><div style="color: white;" class="svelte-1kdig2t"><!--[!--><!--]--> <!----><!---->Articles<!----></div><!----><!--]--></a><!--]--></div><!----> <div style="width: default; height: 32px;" class="clickable svelte-1f9eqjh"><!--[--><a href="/feeds" data-sveltekit-reload="false" data-sveltekit-preload-data="hover" class="svelte-1f9eqjh"><!--[!--><!----><div style="color: white;" class="svelte-1kdig2t"><!--[!--><!--]--> <!----><!---->Feeds<!----></div><!----><!--]--></a><!--]--></div><!----></div></div> <!----><h1>Category: tools</h1> <!--[--><!--[--><div><span class="post-meta svelte-16wmuya">Jun 4, 2025</span> <a href="/articles/joeydebloat"><h2>Finally Talking about JoeyDebloat</h2></a></div> <span>When you use Windows long enough, that list can get big. And I’ve been using Windows for a long, long time now. At least 22 years. Combine that with the mountain of useless, half-baked crap that gets added every year and it’s very easy to have the tweaks and installs take DAYS if done manually.</span><br> <div class="svelte-1gxf1qy"><!--[--><a href="/category/programming/" class="svelte-1gxf1qy">programming</a><a href="/category/software/" class="svelte-1gxf1qy">software</a><a href="/category/tools/" class="svelte-1gxf1qy">tools</a><!--]--></div><!----> <br><br><!--]--><!--[--><div><span class="post-meta svelte-16wmuya">Apr 7, 2025</span> <a href="/articles/tools-proxmox-mem"><h2>Tools: Proxmox Memory Info</h2></a></div> <span>Proxmox doesn’t have a built-in way to check if you’re overcommitting memory on your host. (That I know of?) This is a simple tool that gives you a summary of your memory usage using some shell commands and copypasta.</span><br> <div class="svelte-1gxf1qy"><!--[--><a href="/category/tools/" class="svelte-1gxf1qy">tools</a><a href="/category/proxmox/" class="svelte-1gxf1qy">proxmox</a><a href="/category/software/" class="svelte-1gxf1qy">software</a><!--]--></div><!----> <br><br><!--]--><!--]--><!----><!----></div><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_5gvenx = {
						base: new URL("../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [{"type":"data","data":{categories:["design","ui","meta","life","work","portfolio","programming","software","macos","multiplatform","games","tools","photography","linux","windows","proxmox"]},"uses":{},"slash":"always"},{"type":"data","data":{articles:[{slug:"joeydebloat",path:"/articles/joeydebloat",code:"\u003Cscript context=\"module\">\n\texport const metadata = {\"title\":\"Finally Talking about JoeyDebloat\",\"date\":\"2025-06-04T00:00:00.000Z\",\"categories\":\"programming software tools\",\"comments\":true};\n\tconst { title, date, categories, comments } = metadata;\n\u003C/script>\n\n\u003Cp>I think we all have our laundry list of crap to do when setting up Windows. Install Chrome, some tools, do what you can to make Windows Update and all of the other notifications get out of your face. Some might even go as far as to install \u003Ca\n  href=\"https://techcommunity.microsoft.com/blog/windows-itpro-blog/ltsc-what-is-it-and-when-should-it-be-used/293181\"\n  rel=\"nofollow\"\n>LTSC\u003C/a> (and you probably should, even if M$ doesn’t want you to).\u003C/p>\n\u003Cp>When you use Windows long enough, that list can get big. And I’ve been using Windows for a long, long time now. At least 22 years. Combine that with the mountain of useless, half-baked crap that gets added every year and it’s very easy to have the tweaks and installs take DAYS if done manually.\u003C/p>\n\u003Ch1>The Path Tread Before\u003C/h1>\n\u003Cp>My efforts to stop retreading ground didn’t start with debloating. It started when I had a fleet of student devices to deploy as a Research Assistant in grad school. I had already considered plenty of other solutions before rolling my own:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Deploy a disk image\u003C/strong>: I did end up using this when deploying a bunch of devices at the same time, and it works great when you want everything to have the same stuff. But you will run into collisions with hostnames and other identifiers. For what most people are reading this article for, this isn’t viable.\u003C/li>\n\u003Cli>\u003Cstrong>MDM Solutions\u003C/strong>: Our program did not have the funds for this, otherwise I might’ve tried it. A good solution for managing a fleet, but not so much for personal installs.\u003C/li>\n\u003Cli>\u003Cstrong>Customized Install Media\u003C/strong>: In the context of debloating, this will probably bring memories of TinyXP/10/11. I think it’s clear from their attempts, however impressive they are, that they are NOT the way forward. They’re difficult to audit as safe (\u003Ca\n  href=\"https://github.com/ntdevlabs/tiny11builder\"\n  rel=\"nofollow\"\n>except Tiny11\u003C/a>), difficult to maintain, quickly fall behind in support, and often break updates and other features. You won’t be picking and choosing what you want, you’ll be accepting a very set-in-stone preset that you’ll be committing to (and then distrohopping away from). Oh, and in the context of deploying devices, it’s a pain in the ass there too.\u003C/li>\n\u003Cli>\u003Cstrong>Debloat Scripts and Tools\u003C/strong>: Right, so this is what I settled on. So lets get into this more.\u003C/li>\n\u003C/ul>\n\u003Ch1>Why So Complicated\u003C/h1>\n\u003Cp>There are probably hundreds of Windows debloat tools out there at this point. I’m not going to even try to list them all. But there’s been some patterns I’ve noticed that feel very counterproductive:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>GUI Debloaters\u003C/strong>: I’m not gonna mince words here: \u003Cem>if you make a GUI for your debloater, I think you are wasting your time.\u003C/em> I’m only ever gonna run this thing once when I install Windows. The development effort of maintaining a GUI should be saved for software people are going to interact with on a regular basis. And the quality of most of these programs reflects this: their tweaks tend to break random stuff that they shouldn’t, have insane defaults, and don’t get updated as much as they should.\u003C/li>\n\u003Cli>\u003Cstrong>Maintaining tweaks you don’t even use\u003C/strong>: I can tell a lot of the tweaks in debloaters aren’t actually being used by the people maintaining and distributing them. Ironically, this actually ends up bloating the debloaters with yet more shit that doesn’t work and wasting even more of peoples’ time. I’m not going to claim my debloater is perfect with this but 99% of everything in it I use on a daily basis.\u003C/li>\n\u003Cli>\u003Cstrong>MacroTweaks\u003C/strong>: Each tweak should have a very limited scope. A couple registry keys or commands that do one thing and one thing only. I want to disable Defender, not my firewall (I’m looking at you \u003Ca\n  href=\"https://privacy.sexy/\"\n  rel=\"nofollow\"\n>privacy.sexy\u003C/a>).\u003C/li>\n\u003C/ul>\n\u003Ch1>MiniWinDeploy: A Simple Basis\u003C/h1>\n\u003Cp>That leads me to the first part of my debloat empire: \u003Ca\n  href=\"https://github.com/heyjoeway/miniwindeploy\"\n  rel=\"nofollow\"\n>MiniWinDeploy\u003C/a>. I’m just gonna copy my description here because I think it explains it well:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Stupid simple task runner, intended for deploying/debloating/customizing Windows\u003C/p>\n\u003Cp>…\u003C/p>\n\u003Cp>The following filetypes are recognized:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>bat:  Runs batch script and waits until exit.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>exe:  Runs executable and waits until exit.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>lnk:  Executes shortcut and waits for process to exit.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>msi:  Executes MSI installer silently and waits until finished. Cancels restarts.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>ps1:  Runs Powershell script and waits until exit.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>reg:  Applies registry patch.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>xml:  For XML files beginning with “Wi-Fi-”, registers the wireless profiles.\nIgnores other XML files.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>…\u003C/p>\n\u003Cp>Assume we have the following directory structure in the current working directory and that the current PC model name (as specified in System Information) is \u003Ccode>modelname\u003C/code>:\u003C/p>\n\u003Cpre class=\"language-undefined\">{@html `\u003Ccode class=\"language-undefined\">- All\n|-- 1\n  |-- hello.bat\n|-- 9\n  |-- world.bat\n- Models\n|-- modelname\n  |-- 5\n    |-- model.bat\u003C/code>`}\u003C/pre>\n\u003Cp>The following tasks will be executed, in order:\u003C/p>\n\u003Cpre class=\"language-undefined\">{@html `\u003Ccode class=\"language-undefined\">All/1/hello.bat\nModels/modelname/5/model.bat\nAll/9/world.bat\u003C/code>`}\u003C/pre>\n\u003Cp>All folders in All and Models/modelname are added to a pool, \u003Ca\n  href=\"https://en.wikipedia.org/wiki/Natural_sort_order\"\n  rel=\"nofollow\"\n>sorted naturally\u003C/a>, and then the contents of each directory are executed (after also being naturally sorted). If the modelname directory isn’t present, the script will proceed with a warning.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Yes, that is \u003Cem>all\u003C/em> it does. (Well okay it writes a log too.) It runs executables and applies “tweak files” in the way that makes the most sense for unattended use. The script is 331 LOC that hasn’t been touched in over 2 years. Which is a good thing, because it still works perfect. All of the actual tweaks are kept in a separate repository…\u003C/p>\n\u003Ch1>JoeyDebloat\u003C/h1>\n\u003Cp>Despite the name “JoeyDebloat” the repo has turned into more of a tweak compilation. However, I think these tweaks will be welcomed by most, and for those who aren’t pleased with what it does will instead be pleased by how easy it is to modify.\u003C/p>\n\u003Cp>Some will be familiar with the \u003Ccode>irm | iex\u003C/code> Powershell pattern that allows scripts to be hosted at a URL and be quickly executed with a one-liner. Probably the Most famous example are the \u003Ca\n  href=\"https://github.com/massgravel/Microsoft-Activation-Scripts\"\n  rel=\"nofollow\"\n>Microsoft Activation Scripts\u003C/a>. (Side note: I have no idea why Microsoft hasn’t cracked down on either of these things.)\u003C/p>\n\u003Cblockquote>\n\u003Cp>⚠️ \u003Cstrong>WARNING:\u003C/strong> \u003Ccode>irm | iex\u003C/code> will IMMEDIATELY execute code from the internet on your computer with the permissions of whatever shell you execute it in. It will not respect ExecutionPolicy, it will not warn you about it being unsafe, it will just \u003Cem>GO\u003C/em>.\u003C/p>\n\u003C/blockquote>\n\u003Cp>My goal was to use this pattern to make a one-liner that I could memorize easily. So, my repo contains a \u003Ca\n  href=\"https://github.com/heyjoeway/joeydebloat/blob/main/download.ps1\"\n  rel=\"nofollow\"\n>script\u003C/a> which GitHub Actions deploys to the root of a GitHub Pages website, making it so you can just do this:\u003C/p>\n\u003Cpre class=\"language-powershell\">{@html `\u003Ccode class=\"language-powershell\">\u003Cspan class=\"token function\">irm\u003C/span> http:\u003Cspan class=\"token operator\">/\u003C/span>\u003Cspan class=\"token operator\">/\u003C/span>jojudge\u003Cspan class=\"token punctuation\">.\u003C/span>com/joeydebloat \u003Cspan class=\"token punctuation\">|\u003C/span> \u003Cspan class=\"token function\">iex\u003C/span>\u003C/code>`}\u003C/pre>\n\u003Cp>41 characters, not bad! \u003Cstrong>You should read the contents of the script before running something like this.\u003C/strong> In this case, it will prompt you before making any changes to your system. Quoting once again:\u003C/p>\n\u003Cblockquote>\n\u003Cp>This will install \u003Ca\n  href=\"https://chocolatey.org/install\"\n  rel=\"nofollow\"\n>Chocolatey\u003C/a>, Python 3, Git, and the \u003Ca\n  href=\"https://github.com/heyjoeway/miniwindeploy\"\n  rel=\"nofollow\"\n>miniwindeploy\u003C/a> Python package. It then clones this repo (JoeyDebloat) and opens it in File Explorer. From there, change whatever scripts you’d like, then open Start.bat.\u003C/p>\n\u003C/blockquote>\n\u003Cp>To be clear, when this script has finished running the only thing it will have done is install the aforementioned programs. No debloating/tweaking has been done yet. It will open file explorer, but before clicking \u003Ccode>Start.bat\u003C/code> you may want to explore the \u003Ccode>All\u003C/code> folder to see what exactly it’s going to do to your system.\u003C/p>\n\u003Cp>This is the best part about this approach: if you don’t like a tweak, you just delete it. It uses your existing knowledge of using file explorer to subvert the need for a GUI. On the other side, if I ever want to add a tweak, I can just drop it into the repo as a file. And if you want to stay posted with what I’ve been changing, \u003Ca\n  href=\"https://github.com/heyjoeway/joeydebloat/commits/main/\"\n  rel=\"nofollow\"\n>you can just check the commit history\u003C/a>. Why reinvent the wheel when you already have all the tools?\u003C/p>\n\u003Cp>So, okay, what does this actually do? Well, if I listed everything we’d be here for hours and I’m also not gonna keep this article up to date. I was gonna do a brief overview but I don’t even think that’s worth it. \u003Ca\n  href=\"https://github.com/heyjoeway/joeydebloat/tree/main/All\"\n  rel=\"nofollow\"\n>Each tweak is titled with a description of what it will do\u003C/a>, and to make things a bit easier to parse I’ve moved the more opinionated tweaks into separate folders. The general pattern is this: make Windows as quiet and well-behaved as possible, then add programs that I’m bound to download eventually.\u003C/p>\n\u003Cp>You may have come to this article with the express interest of seeing what the debloat actually does. I think for people really interested in doing this, knowing how to efficiently maintain a tweak library themselves is going to be significantly more useful than relying on some random dude with no incentive to tailor their tweaks to everyone’s lifestyle.\u003C/p>\n\u003Ch1>:fork:\u003C/h1>\n\u003Cp>So you want to add your own tweaks. Or you want to suggest ones to add to my repo. Get on your GitHub account and fork the repo. After that, you’ll have a couple things to change:\u003C/p>\n\u003Cul>\n\u003Cli>You might want to rename the repo. Unless your name is also Joe.\u003C/li>\n\u003Cli>\u003Ccode>download.ps1\u003C/code>: Replace the URL of my repo with yours.\u003C/li>\n\u003Cli>If you want the \u003Ccode>irm | iex\u003C/code> one liner:\n\u003Cul>\n\u003Cli>Configure GitHub Pages. I’m not gonna do a step by step on this, but the GitHub Actions deployment should work without changes. If anyone has more detailed instructions, either comment or leave it as a GitHub issue.\u003C/li>\n\u003Cli>\u003Ccode>README.md\u003C/code>: Replace the URL of the \u003Ccode>irm | iex\u003C/code> script with your GitHub Page.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cp>You’ll still need to know how to use Git in order to maintain this, but if that’s not in your wheelhouse then maintaining this might not be either.\u003C/p>\n\u003Ch1>tldr\u003C/h1>\n\u003Cul>\n\u003Cli>Stop retreading ground\u003C/li>\n\u003Cli>Keep debloaters simple for both parties\u003C/li>\n\u003Cli>Curate only tweaks you will actually test\u003C/li>\n\u003Cli>Be careful executing random code from the net\u003C/li>\n\u003C/ul>\n\u003Ch1>Shoutout to\u003C/h1>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://privacy.sexy/\" rel=\"nofollow\">privacy.sexy\u003C/a>: For a crapton of tweaks\u003C/li>\n\u003Cli>\u003Ca href=\"https://www.elevenforum.com/\" rel=\"nofollow\">elevenforum.com\u003C/a>: For being the only good Windows troubleshooting site (and for more tweaks)\u003C/li>\n\u003Cli>And to all the people making miscellaneous tweaks in random forums\u003C/li>\n\u003C/ul>\n",fm:{title:"Finally Talking about JoeyDebloat",date:new Date(1748995200000),categories:"programming software tools",comments:true,last_modified_at:"2025-06-04T12:02:51-04:00"}},{slug:"tools-proxmox-mem",path:"/articles/tools-proxmox-mem",code:"\u003Cscript context=\"module\">\n\texport const metadata = {\"title\":\"Tools: Proxmox Memory Info\",\"comments\":true,\"categories\":\"tools proxmox software\"};\n\tconst { title, comments, categories } = metadata;\n\u003C/script>\n\u003Cscript lang=\"ts\">\n    import { styleObjToStr } from \"$lib/Utils.js\";\n    import Textarea from \"$joeysvelte/Textarea.svelte\";\n    \n    let qmListStr = `\\\n      VMID NAME                 STATUS     MEM(MB)    BOOTDISK(GB) PID       \n       100 fdsa                 running    4608              32.00 2826770   \n       101 asdf                 running    8192              24.00 2828068   \n       103 vcxz                 running    6144             170.00 4083340   \n       106 zxcv                 running    512                0.00 2829680   \n       107 rewq                 running    512                8.00 2828256   \n       108 qwer                 running    10240            280.00 2828390   \n       116 poiu                 stopped    1024              16.00 0         \n       119 uiop                 running    2048              16.00 2828601   \n`;\n    let pctListStr = `\\\ncpus: 4\ndisk: 8607637504\ndiskread: 5604175872\ndiskwrite: 5664735232\nmaxdisk: 16729894912\nmaxmem: 1610612736\nmaxswap: 268435456\nmem: 103804928\nname: zaq\nnetin: 1609895403\nnetout: 321521108\npid: 2819704\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486378\nvmid: 102\n===\ncpus: 2\ndisk: 2569617408\ndiskread: 2268246016\ndiskwrite: 1185574912\nmaxdisk: 8350298112\nmaxmem: 2147483648\nmaxswap: 536870912\nmem: 446955520\nname: qaz\nnetin: 203442269\nnetout: 103766012\npid: 2819932\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486377\nvmid: 104\n===\ncpus: 2\ndisk: 14933626880\ndiskread: 50094080\ndiskwrite: 0\nmaxdisk: 33501757440\nmaxmem: 3221225472\nmaxswap: 536870912\nmem: 809078784\nname: xsw\nnetin: 1082231849\nnetout: 490525835\npid: 2820482\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486376\nvmid: 105\n===\ncpus: 1\ndisk: 1718788096\ndiskread: 8668491776\ndiskwrite: 4616585216\nmaxdisk: 8350298112\nmaxmem: 268435456\nmaxswap: 134217728\nmem: 125739008\nname: wsx\nnetin: 1890712714\nnetout: 260634596\npid: 2820755\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486375\nvmid: 109\n===\ncpus: 4\ndisk: 2408054784\ndiskread: 597217280\ndiskwrite: 0\nmaxdisk: 25769803776\nmaxmem: 4294967296\nmaxswap: 536870912\nmem: 2604072960\nname: cde\nnetin: 128455070\nnetout: 90778783\npid: 2817017\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486459\nvmid: 110\n===\ncpus: 1\ndisk: 2349285376\ndiskread: 15766028288\ndiskwrite: 28394274816\nmaxdisk: 8350298112\nmaxmem: 805306368\nmaxswap: 268435456\nmem: 40759296\nname: edc\nnetin: 1229295854\nnetout: 1045237055\npid: 2821383\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486373\nvmid: 111\n===\ncpus: 1\ndisk: 5181554688\ndiskread: 28819456\ndiskwrite: 0\nmaxdisk: 8350298112\nmaxmem: 402653184\nmaxswap: 134217728\nmem: 136101888\nname: vfr\nnetin: 120298060\nnetout: 1821795\npid: 2821938\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486373\nvmid: 112\n===\ncpus: 1\ndisk: 1094844416\ndiskread: 3101143040\ndiskwrite: 527785984\nmaxdisk: 8350298112\nmaxmem: 201326592\nmaxswap: 134217728\nmem: 33763328\nname: rfv\nnetin: 154376120\nnetout: 1976845\npid: 2822212\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486373\nvmid: 113\n===\ncpus: 4\ndisk: 6096498688\ndiskread: 8319344640\ndiskwrite: 6460186624\nmaxdisk: 16729894912\nmaxmem: 1610612736\nmaxswap: 536870912\nmem: 262180864\nname: bgt\nnetin: 107645972018\nnetout: 7305682389\npid: 2822414\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486372\nvmid: 114\n===\ncpus: 1\ndisk: 1116786688\ndiskread: 5317419008\ndiskwrite: 969625600\nmaxdisk: 8350298112\nmaxmem: 134217728\nmaxswap: 134217728\nmem: 32182272\nname: tgb\nnetin: 27261214\nnetout: 3653634\npid: 2822936\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486372\nvmid: 115\n===\ncpus: 1\ndisk: 0\ndiskread: 0\ndiskwrite: 0\nmaxdisk: 8589934592\nmaxmem: 268435456\nmaxswap: 134217728\nmem: 0\nname: nhy\nnetin: 0\nnetout: 0\nstatus: stopped\nswap: 0\ntype: lxc\nuptime: 0\nvmid: 117\n===\ncpus: 1\ndisk: 1221087232\ndiskread: 1466032128\ndiskwrite: 630587392\nmaxdisk: 16729894912\nmaxmem: 536870912\nmaxswap: 134217728\nmem: 169148416\nname: yhn\nnetin: 156576103\nnetout: 5348044\npid: 2825177\nstatus: running\nswap: 0\ntype: lxc\nuptime: 486353\nvmid: 118\n===\ncpus: 2\ndisk: 0\ndiskread: 0\ndiskwrite: 0\nmaxdisk: 17179869184\nmaxmem: 2147483648\nmaxswap: 536870912\nmem: 0\nname: mju\nnetin: 0\nnetout: 0\nstatus: stopped\nswap: 0\ntype: lxc\nuptime: 0\nvmid: 121\n===\n`;;\n    let meminfoStr = `\\\nMemTotal:       48588200 kB\nMemFree:         2121064 kB\nMemAvailable:    5148580 kB\nBuffers:          165496 kB\nCached:          3197324 kB\nSwapCached:            0 kB\nActive:         14693372 kB\nInactive:       26106296 kB\nActive(anon):   13714084 kB\nInactive(anon): 23904072 kB\nActive(file):     979288 kB\nInactive(file):  2202224 kB\nUnevictable:           0 kB\nMlocked:               0 kB\nSwapTotal:             0 kB\nSwapFree:              0 kB\nZswap:                 0 kB\nZswapped:              0 kB\nDirty:               396 kB\nWriteback:             0 kB\nAnonPages:      37436860 kB\nMapped:           924520 kB\nShmem:            183060 kB\nKReclaimable:     435548 kB\nSlab:            1441200 kB\nSReclaimable:     435548 kB\nSUnreclaim:      1005652 kB\nKernelStack:       21552 kB\nPageTables:       124804 kB\nSecPageTables:     11676 kB\nNFS_Unstable:          0 kB\nBounce:                0 kB\nWritebackTmp:          0 kB\nCommitLimit:    24294100 kB\nCommitted_AS:   46479152 kB\nVmallocTotal:   34359738367 kB\nVmallocUsed:      823808 kB\nVmallocChunk:          0 kB\nPercpu:            73984 kB\nHardwareCorrupted:     0 kB\nAnonHugePages:  26798080 kB\nShmemHugePages:        0 kB\nShmemPmdMapped:        0 kB\nFileHugePages:         0 kB\nFilePmdMapped:         0 kB\nUnaccepted:            0 kB\nHugePages_Total:       0\nHugePages_Free:        0\nHugePages_Rsvd:        0\nHugePages_Surp:        0\nHugepagesize:       2048 kB\nHugetlb:               0 kB\nDirectMap4k:      595876 kB\nDirectMap2M:    15441920 kB\nDirectMap1G:    34603008 kB\n`;\n\nfunction keyColonValueToRecord(str: string) {\n    return str.split('\\n').reduce((acc, line) => {\n        const [key, value] = line.split(':').map(s => s.trim());\n        if (!key) return acc;\n        try {\n            acc[key] = parseFloat(value);\n            if (isNaN(acc[key])) throw new Error('Not a number');\n            if (acc[key].toString() != value) {\n                throw new Error('Does not look like a number');\n            }\n        } catch (e) {\n            acc[key] = value;\n        }\n        return acc;\n    }, {} as Record\u003Cstring, any>);\n}\n\nfunction spaceDelimitedTableToRecordList(str: string) {\n    const lines = str.split('\\n').map(s => s.trim()).filter(s => s.length > 0);\n    const headers = lines[0].split(/\\s+/);\n    return lines.slice(1).map(line => {\n        const values = line.split(/\\s+/);\n        return headers.reduce((acc, header, i) => {\n            acc[header] = values[i];\n            return acc;\n        }, {} as Record\u003Cstring, string | number>);\n    });\n}\n\nfunction parseQmListStr(qmListStr: string) {\n    let data = spaceDelimitedTableToRecordList(qmListStr);\n    \n    let outRecord = {};\n        \n    data.forEach(item => {\n        const key = item['VMID'];\n        delete item['VMID'];\n        item['MEM'] = parseFloat(item['MEM(MB)'] as string) * 1024 * 1024;\n        delete item['MEM(MB)'];\n        item['BOOTDISK'] = parseFloat(item['BOOTDISK(GB)'] as string) * 1024 * 1024 * 1024;\n        delete item['BOOTDISK(GB)'];\n        outRecord[key] = item;\n    });\n    \n    return outRecord;\n}\n\nfunction parsePctListStr(pctListStr: string) {\n    const splitByContainer = (\n        pctListStr.split('===')\n            .map(s => s.trim())\n            .filter(s => s.length > 0)\n    );\n    \n    let outRecord = {};\n        \n    splitByContainer.forEach(containerStr => {\n        let data = keyColonValueToRecord(containerStr);\n        const key = data['vmid'];\n        delete data['vmid'];\n        outRecord[key] = data;\n    });\n    \n    return outRecord;\n}\n\nfunction parseMeminfoStr(meminfoStr: string) {\n    let data = keyColonValueToRecord(meminfoStr);\n    for (const key in data) {\n        const value = data[key];\n        if (typeof value == 'string') {\n            if (value.endsWith(' kB')) {\n                data[key] = parseInt(value.slice(0, -3)) * 1024;\n            } else if (value.endsWith(' MB')) {\n                data[key] = parseInt(value.slice(0, -3)) * 1024 * 1024;\n            } else {\n                data[key] = parseInt(value);\n            }\n        } else {\n            data[key] = value;\n        }\n    }\n    return data;\n}\n\nfunction bytesToGBStr(bytes: number) {\n    let gb = bytes / 1024 / 1024 / 1024;\n    return gb.toFixed(2) + \" GB\";\n}\n\nlet qmRecord: Record\u003Cstring, Record\u003Cstring, string | number>>;\nlet pctRecord: Record\u003Cstring, Record\u003Cstring, string | number>>;\nlet meminfoRecord: Record\u003Cstring, string | number>;\n\n$: qmRecord = parseQmListStr(qmListStr);\n$: pctRecord = parsePctListStr(pctListStr);\n$: meminfoRecord = parseMeminfoStr(meminfoStr);\n\nfunction sumArr(arr: number[]) {\n    return arr.reduce((acc, val) => acc + val, 0);\n}\n\nlet currentItemMemTotal: number;\n$: currentItemMemTotal = (\n    sumArr(Object.values(pctRecord).map(data => data.mem as number))\n    + sumArr(Object.values(qmRecord).map(data => (\n        data.STATUS == 'running'\n        ? data.MEM as number\n        : 0\n    )))\n);\n\nlet maxItemMemTotal: number;\n$: maxItemMemTotal = (\n    sumArr(Object.values(pctRecord).map(data => data.maxmem as number))\n    + sumArr(Object.values(qmRecord).map(data => data.MEM as number))\n);\n\nlet currentSystemMem: number;\n$: currentSystemMem = (\n    (meminfoRecord.MemTotal as number)\n    - (meminfoRecord.MemAvailable as number)\n);\n\nlet hostMemUsed: number;\n$: hostMemUsed = currentSystemMem - currentItemMemTotal;\n\nlet maxMemUse: number;\n$: maxMemUse = hostMemUsed + maxItemMemTotal;\n\nlet memAvailableForProvisioning: number;\n$: memAvailableForProvisioning = (meminfoRecord.MemTotal as number) - maxMemUse;\n\n\u003C/script>\n\n\n\u003Cp>Proxmox doesn’t have a built-in way to check if you’re overcommitting memory on your host. (That I know of?) This is a simple tool that gives you a summary of your memory usage using some shell commands and copypasta.\u003C/p>\n\u003Ch2>Paste the output of…\u003C/h2>\n\u003Cpre class=\"language-bash\">{@html `\u003Ccode class=\"language-bash\">qm list\u003C/code>`}\u003C/pre>\n\u003Cp>down here:\u003C/p>\n\u003CTextarea bind:value={qmListStr} />\n\u003Ch2>Paste the output of…\u003C/h2>\n\u003Cpre class=\"language-bash\">{@html `\u003Ccode class=\"language-bash\">pct list \u003Cspan class=\"token operator\">|\u003C/span> \u003Cspan class=\"token function\">grep\u003C/span> \u003Cspan class=\"token parameter variable\">-v\u003C/span> VMID \u003Cspan class=\"token operator\">|\u003C/span> \u003Cspan class=\"token function\">awk\u003C/span> \u003Cspan class=\"token string\">'&#123;'\u003C/span>\u003Cspan class=\"token punctuation\">&#123;\u003C/span>\u003Cspan class=\"token string\">'&#125; print $1 &#123;'\u003C/span>\u003Cspan class=\"token punctuation\">&#125;\u003C/span>\u003Cspan class=\"token string\">'&#125;'\u003C/span> \u003Cspan class=\"token operator\">|\u003C/span> \u003Cspan class=\"token function\">xargs\u003C/span> \u003Cspan class=\"token parameter variable\">-I\u003C/span> x \u003Cspan class=\"token function\">sh\u003C/span> \u003Cspan class=\"token parameter variable\">-c\u003C/span> \u003Cspan class=\"token string\">'pct status x -verbose &amp;&amp; echo ==='\u003C/span>\u003C/code>`}\u003C/pre>\n\u003Cp>down here:\u003C/p>\n\u003CTextarea bind:value={pctListStr} />\n\u003Ch2>Paste the output of…\u003C/h2>\n\u003Cpre class=\"language-bash\">{@html `\u003Ccode class=\"language-bash\">\u003Cspan class=\"token function\">cat\u003C/span> /proc/meminfo\u003C/code>`}\u003C/pre>\n\u003Cp>down here:\u003C/p>\n\u003CTextarea bind:value={meminfoStr} />\n\u003Ch2>Results\u003C/h2>\n\u003Ctable>\n    \u003Cthead>\n        \u003Ctr>\n            \u003Cth>\u003C/th>\n            \u003Cth>VM ID\u003C/th>\n            \u003Cth>Name\u003C/th>\n            \u003Cth>Type\u003C/th>\n            \u003Cth>Status\u003C/th>\n            \u003Cth style=\"text-align:right\">Current Mem.\u003C/th>\n            \u003Cth style=\"text-align:right\">Max Mem.\u003C/th>\n        \u003C/tr>\n    \u003C/thead>\n    \u003Ctbody>\n        {#each Object.entries(pctRecord) as [vmid, data]}\n            \u003Ctr>\n                \u003Ctd>\u003C/td>\n                \u003Ctd>{vmid}\u003C/td>\n                \u003Ctd>{data.name}\u003C/td>\n                \u003Ctd>{data.type}\u003C/td>\n                \u003Ctd>{data.status}\u003C/td>\n                \u003Ctd style=\"text-align:right\">{bytesToGBStr(data.mem as number)}\u003C/td>\n                \u003Ctd style=\"text-align:right\">{bytesToGBStr(data.maxmem as number)}\u003C/td>\n            \u003C/tr>\n        {/each}\n        {#each Object.entries(qmRecord) as [vmid, data]}\n            \u003Ctr>\n                \u003Ctd>\u003C/td>\n                \u003Ctd>{vmid}\u003C/td>\n                \u003Ctd>{data.NAME}\u003C/td>\n                \u003Ctd>qemu\u003C/td>\n                \u003Ctd>{data.STATUS}\u003C/td>\n                \u003Ctd style=\"text-align:right\">{data.STATUS == \"running\" ? bytesToGBStr(data.MEM as number) : 0}\u003C/td>\n                \u003Ctd style=\"text-align:right\">{bytesToGBStr(data.MEM as number)}\u003C/td>\n            \u003C/tr>\n        {/each}\n        \u003Ctr>\n            \u003Ctd>\u003Cb>Totals\u003C/b>\u003C/td>\n            \u003Ctd>\u003C/td>\n            \u003Ctd>\u003C/td>\n            \u003Ctd>\u003C/td>\n            \u003Ctd>\u003C/td>\n            \u003Ctd style=\"text-align:right\">\n                \u003Cb>{bytesToGBStr(currentItemMemTotal)}\u003C/b>\n            \u003C/td>\n            \u003Ctd style=\"text-align:right\">\n                \u003Cb>{bytesToGBStr(maxItemMemTotal)}\u003C/b>\n            \u003C/td>\n        \u003C/tr>\n\u003C/table>\n\u003Ctable>\n    \u003Ctbody>\n        \u003Ctr>\n            \u003Cth>Current System Memory Usage\u003C/th>\n            \u003Ctd>{bytesToGBStr(currentSystemMem)}\u003C/td>\n        \u003C/tr>\n        \u003Ctr>\n            \u003Cth>Memory Used by Host\u003C/th>\n            \u003Ctd>{bytesToGBStr(hostMemUsed)}\u003C/td>\n        \u003C/tr>\n        \u003Ctr>\n            \u003Cth>Max Potential Memory Use\u003C/th>\n            \u003Ctd>{bytesToGBStr(maxMemUse)}\u003C/td>\n        \u003C/tr>\n        \u003Ctr>\n            \u003Cth>Total Host Memory\u003C/th>\n            \u003Ctd>{bytesToGBStr(meminfoRecord.MemTotal as number)}\u003C/td>\n        \u003C/tr>\n        \u003Ctr>\n            \u003Cth>Available for Provisioning\u003C/th>\n             \u003Ctd\n                style={styleObjToStr({\n                    color: (\n                        memAvailableForProvisioning > 0\n                        ? \"green\"\n                        : \"hotpink\"\n                    )\n                })}\n            >\n                {bytesToGBStr(memAvailableForProvisioning)}\n        \u003C/td>\n        \u003C/tr>\n    \u003C/tbody>\n\u003C/table>\n",fm:{title:"Tools: Proxmox Memory Info",comments:true,categories:"tools proxmox software",last_modified_at:"2025-04-07T13:57:11-04:00",date:"2025-04-07T13:57:11-04:00"}}],slug:"tools"},"uses":{"params":["slug"]}}];

					Promise.all([
						import("../../_app/immutable/entry/start.CdXfjAUR.js"),
						import("../../_app/immutable/entry/app.B26TLaZb.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 25],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
